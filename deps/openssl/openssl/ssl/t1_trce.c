/* ssl/t1_trce.c */
/*
 * Written by Dr Stephen N Henson (steve@openssl.org) for the OpenSSL
 * project.
 */
/* ====================================================================
 * Copyright (c) 2012 The OpenSSL Project.  All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 *
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 *
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in
 *    the documentation and/or other materials provided with the
 *    distribution.
 *
 * 3. All advertising materials mentioning features or use of this
 *    software must display the following acknowledgment:
 *    "This product includes software developed by the OpenSSL Project
 *    for use in the OpenSSL Toolkit. (http://www.OpenSSL.org/)"
 *
 * 4. The names "\x4f\x70\x65\x6e\x53\x53\x4c\x20\x54\x6f\x6f\x6c\x6b\x69\x74" and "\x4f\x70\x65\x6e\x53\x53\x4c\x20\x50\x72\x6f\x6a\x65\x63\x74" must not be used to
 *    endorse or promote products derived from this software without
 *    prior written permission. For written permission, please contact
 *    licensing@OpenSSL.org.
 *
 * 5. Products derived from this software may not be called "\x4f\x70\x65\x6e\x53\x53\x4c"
 *    nor may "\x4f\x70\x65\x6e\x53\x53\x4c" appear in their names without prior written
 *    permission of the OpenSSL Project.
 *
 * 6. Redistributions of any form whatsoever must retain the following
 *    acknowledgment:
 *    "This product includes software developed by the OpenSSL Project
 *    for use in the OpenSSL Toolkit (http://www.OpenSSL.org/)"
 *
 * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY
 * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR
 * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
 * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
 * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
 * OF THE POSSIBILITY OF SUCH DAMAGE.
 * ====================================================================
 *
 */

#include "ssl_locl.h"

#ifndef OPENSSL_NO_SSL_TRACE

/* Packet trace support for OpenSSL */

typedef struct {
    int num;
    const char *name;
} ssl_trace_tbl;

# define ssl_trace_str(val, tbl) \
        do_ssl_trace_str(val, tbl, sizeof(tbl)/sizeof(ssl_trace_tbl))

# define ssl_trace_list(bio, indent, msg, msglen, value, table) \
        do_ssl_trace_list(bio, indent, msg, msglen, value, \
         table, sizeof(table)/sizeof(ssl_trace_tbl))

static const char *do_ssl_trace_str(int val, ssl_trace_tbl *tbl, size_t ntbl)
{
    size_t i;
    for (i = 0; i < ntbl; i++, tbl++) {
        if (tbl->num == val)
            return tbl->name;
    }
    return "\x55\x4e\x4b\x4e\x4f\x57\x4e";
}

static int do_ssl_trace_list(BIO *bio, int indent,
                             const unsigned char *msg, size_t msglen,
                             size_t vlen, ssl_trace_tbl *tbl, size_t ntbl)
{
    int val;
    if (msglen % vlen)
        return 0;
    while (msglen) {
        val = msg[0];
        if (vlen == 2)
            val = (val << 8) | msg[1];
        BIO_indent(bio, indent, 80);
        BIO_printf(bio, "\x25\x73\x20\x28\x25\x64\x29\xa", do_ssl_trace_str(val, tbl, ntbl), val);
        msg += vlen;
        msglen -= vlen;
    }
    return 1;
}

/* Version number */

static ssl_trace_tbl ssl_version_tbl[] = {
    {SSL2_VERSION, "\x53\x53\x4c\x20\x32\x2e\x30"},
    {SSL3_VERSION, "\x53\x53\x4c\x20\x33\x2e\x30"},
    {TLS1_VERSION, "\x54\x4c\x53\x20\x31\x2e\x30"},
    {TLS1_1_VERSION, "\x54\x4c\x53\x20\x31\x2e\x31"},
    {TLS1_2_VERSION, "\x54\x4c\x53\x20\x31\x2e\x32"},
    {DTLS1_VERSION, "\x44\x54\x4c\x53\x20\x31\x2e\x30"},
    {DTLS1_2_VERSION, "\x44\x54\x4c\x53\x20\x31\x2e\x32"},
    {DTLS1_BAD_VER, "\x44\x54\x4c\x53\x20\x31\x2e\x30\x20\x28\x62\x61\x64\x29"}
};

static ssl_trace_tbl ssl_content_tbl[] = {
    {SSL3_RT_CHANGE_CIPHER_SPEC, "\x43\x68\x61\x6e\x67\x65\x43\x69\x70\x68\x65\x72\x53\x70\x65\x63"},
    {SSL3_RT_ALERT, "\x41\x6c\x65\x72\x74"},
    {SSL3_RT_HANDSHAKE, "\x48\x61\x6e\x64\x73\x68\x61\x6b\x65"},
    {SSL3_RT_APPLICATION_DATA, "\x41\x70\x70\x6c\x69\x63\x61\x74\x69\x6f\x6e\x44\x61\x74\x61"},
    {TLS1_RT_HEARTBEAT, "\x48\x65\x61\x72\x74\x42\x65\x61\x74"}
};

/* Handshake types */
static ssl_trace_tbl ssl_handshake_tbl[] = {
    {SSL3_MT_HELLO_REQUEST, "\x48\x65\x6c\x6c\x6f\x52\x65\x71\x75\x65\x73\x74"},
    {SSL3_MT_CLIENT_HELLO, "\x43\x6c\x69\x65\x6e\x74\x48\x65\x6c\x6c\x6f"},
    {SSL3_MT_SERVER_HELLO, "\x53\x65\x72\x76\x65\x72\x48\x65\x6c\x6c\x6f"},
    {DTLS1_MT_HELLO_VERIFY_REQUEST, "\x48\x65\x6c\x6c\x6f\x56\x65\x72\x69\x66\x79\x52\x65\x71\x75\x65\x73\x74"},
    {SSL3_MT_NEWSESSION_TICKET, "\x4e\x65\x77\x53\x65\x73\x73\x69\x6f\x6e\x54\x69\x63\x6b\x65\x74"},
    {SSL3_MT_CERTIFICATE, "\x43\x65\x72\x74\x69\x66\x69\x63\x61\x74\x65"},
    {SSL3_MT_SERVER_KEY_EXCHANGE, "\x53\x65\x72\x76\x65\x72\x4b\x65\x79\x45\x78\x63\x68\x61\x6e\x67\x65"},
    {SSL3_MT_CERTIFICATE_REQUEST, "\x43\x65\x72\x74\x69\x66\x69\x63\x61\x74\x65\x52\x65\x71\x75\x65\x73\x74"},
    {SSL3_MT_CLIENT_KEY_EXCHANGE, "\x43\x6c\x69\x65\x6e\x74\x4b\x65\x79\x45\x78\x63\x68\x61\x6e\x67\x65"},
    {SSL3_MT_CERTIFICATE_STATUS, "\x43\x65\x72\x74\x69\x66\x69\x63\x61\x74\x65\x53\x74\x61\x74\x75\x73"},
    {SSL3_MT_SERVER_DONE, "\x53\x65\x72\x76\x65\x72\x48\x65\x6c\x6c\x6f\x44\x6f\x6e\x65"},
    {SSL3_MT_CERTIFICATE_VERIFY, "\x43\x65\x72\x74\x69\x66\x69\x63\x61\x74\x65\x56\x65\x72\x69\x66\x79"},
    {SSL3_MT_CLIENT_KEY_EXCHANGE, "\x43\x6c\x69\x65\x6e\x74\x4b\x65\x79\x45\x78\x63\x68\x61\x6e\x67\x65"},
    {SSL3_MT_FINISHED, "\x46\x69\x6e\x69\x73\x68\x65\x64"},
    {SSL3_MT_CERTIFICATE_STATUS, "\x43\x65\x72\x74\x69\x66\x69\x63\x61\x74\x65\x53\x74\x61\x74\x75\x73"}
};

/* Cipher suites */
static ssl_trace_tbl ssl_ciphers_tbl[] = {
    {0x0000, "\x53\x53\x4c\x5f\x4e\x55\x4c\x4c\x5f\x57\x49\x54\x48\x5f\x4e\x55\x4c\x4c\x5f\x4e\x55\x4c\x4c"},
    {0x0001, "\x53\x53\x4c\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x4e\x55\x4c\x4c\x5f\x4d\x44\x35"},
    {0x0002, "\x53\x53\x4c\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x4e\x55\x4c\x4c\x5f\x53\x48\x41"},
    {0x0003, "\x53\x53\x4c\x5f\x52\x53\x41\x5f\x45\x58\x50\x4f\x52\x54\x5f\x57\x49\x54\x48\x5f\x52\x43\x34\x5f\x34\x30\x5f\x4d\x44\x35"},
    {0x0004, "\x53\x53\x4c\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x52\x43\x34\x5f\x31\x32\x38\x5f\x4d\x44\x35"},
    {0x0005, "\x53\x53\x4c\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x52\x43\x34\x5f\x31\x32\x38\x5f\x53\x48\x41"},
    {0x0006, "\x53\x53\x4c\x5f\x52\x53\x41\x5f\x45\x58\x50\x4f\x52\x54\x5f\x57\x49\x54\x48\x5f\x52\x43\x32\x5f\x43\x42\x43\x5f\x34\x30\x5f\x4d\x44\x35"},
    {0x0007, "\x53\x53\x4c\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x49\x44\x45\x41\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0008, "\x53\x53\x4c\x5f\x52\x53\x41\x5f\x45\x58\x50\x4f\x52\x54\x5f\x57\x49\x54\x48\x5f\x44\x45\x53\x34\x30\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0009, "\x53\x53\x4c\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x44\x45\x53\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x000A, "\x53\x53\x4c\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x33\x44\x45\x53\x5f\x45\x44\x45\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x000B, "\x53\x53\x4c\x5f\x44\x48\x5f\x44\x53\x53\x5f\x45\x58\x50\x4f\x52\x54\x5f\x57\x49\x54\x48\x5f\x44\x45\x53\x34\x30\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x000C, "\x53\x53\x4c\x5f\x44\x48\x5f\x44\x53\x53\x5f\x57\x49\x54\x48\x5f\x44\x45\x53\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x000D, "\x53\x53\x4c\x5f\x44\x48\x5f\x44\x53\x53\x5f\x57\x49\x54\x48\x5f\x33\x44\x45\x53\x5f\x45\x44\x45\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x000E, "\x53\x53\x4c\x5f\x44\x48\x5f\x52\x53\x41\x5f\x45\x58\x50\x4f\x52\x54\x5f\x57\x49\x54\x48\x5f\x44\x45\x53\x34\x30\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x000F, "\x53\x53\x4c\x5f\x44\x48\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x44\x45\x53\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0010, "\x53\x53\x4c\x5f\x44\x48\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x33\x44\x45\x53\x5f\x45\x44\x45\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0011, "\x53\x53\x4c\x5f\x44\x48\x45\x5f\x44\x53\x53\x5f\x45\x58\x50\x4f\x52\x54\x5f\x57\x49\x54\x48\x5f\x44\x45\x53\x34\x30\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0012, "\x53\x53\x4c\x5f\x44\x48\x45\x5f\x44\x53\x53\x5f\x57\x49\x54\x48\x5f\x44\x45\x53\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0013, "\x53\x53\x4c\x5f\x44\x48\x45\x5f\x44\x53\x53\x5f\x57\x49\x54\x48\x5f\x33\x44\x45\x53\x5f\x45\x44\x45\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0014, "\x53\x53\x4c\x5f\x44\x48\x45\x5f\x52\x53\x41\x5f\x45\x58\x50\x4f\x52\x54\x5f\x57\x49\x54\x48\x5f\x44\x45\x53\x34\x30\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0015, "\x53\x53\x4c\x5f\x44\x48\x45\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x44\x45\x53\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0016, "\x53\x53\x4c\x5f\x44\x48\x45\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x33\x44\x45\x53\x5f\x45\x44\x45\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0017, "\x53\x53\x4c\x5f\x44\x48\x5f\x61\x6e\x6f\x6e\x5f\x45\x58\x50\x4f\x52\x54\x5f\x57\x49\x54\x48\x5f\x52\x43\x34\x5f\x34\x30\x5f\x4d\x44\x35"},
    {0x0018, "\x53\x53\x4c\x5f\x44\x48\x5f\x61\x6e\x6f\x6e\x5f\x57\x49\x54\x48\x5f\x52\x43\x34\x5f\x31\x32\x38\x5f\x4d\x44\x35"},
    {0x0019, "\x53\x53\x4c\x5f\x44\x48\x5f\x61\x6e\x6f\x6e\x5f\x45\x58\x50\x4f\x52\x54\x5f\x57\x49\x54\x48\x5f\x44\x45\x53\x34\x30\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x001A, "\x53\x53\x4c\x5f\x44\x48\x5f\x61\x6e\x6f\x6e\x5f\x57\x49\x54\x48\x5f\x44\x45\x53\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x001B, "\x53\x53\x4c\x5f\x44\x48\x5f\x61\x6e\x6f\x6e\x5f\x57\x49\x54\x48\x5f\x33\x44\x45\x53\x5f\x45\x44\x45\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x001D, "\x53\x53\x4c\x5f\x46\x4f\x52\x54\x45\x5a\x5a\x41\x5f\x4b\x45\x41\x5f\x57\x49\x54\x48\x5f\x46\x4f\x52\x54\x45\x5a\x5a\x41\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x001E, "\x53\x53\x4c\x5f\x46\x4f\x52\x54\x45\x5a\x5a\x41\x5f\x4b\x45\x41\x5f\x57\x49\x54\x48\x5f\x52\x43\x34\x5f\x31\x32\x38\x5f\x53\x48\x41"},
    {0x001F, "\x54\x4c\x53\x5f\x4b\x52\x42\x35\x5f\x57\x49\x54\x48\x5f\x33\x44\x45\x53\x5f\x45\x44\x45\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0020, "\x54\x4c\x53\x5f\x4b\x52\x42\x35\x5f\x57\x49\x54\x48\x5f\x52\x43\x34\x5f\x31\x32\x38\x5f\x53\x48\x41"},
    {0x0021, "\x54\x4c\x53\x5f\x4b\x52\x42\x35\x5f\x57\x49\x54\x48\x5f\x49\x44\x45\x41\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0022, "\x54\x4c\x53\x5f\x4b\x52\x42\x35\x5f\x57\x49\x54\x48\x5f\x44\x45\x53\x5f\x43\x42\x43\x5f\x4d\x44\x35"},
    {0x0023, "\x54\x4c\x53\x5f\x4b\x52\x42\x35\x5f\x57\x49\x54\x48\x5f\x33\x44\x45\x53\x5f\x45\x44\x45\x5f\x43\x42\x43\x5f\x4d\x44\x35"},
    {0x0024, "\x54\x4c\x53\x5f\x4b\x52\x42\x35\x5f\x57\x49\x54\x48\x5f\x52\x43\x34\x5f\x31\x32\x38\x5f\x4d\x44\x35"},
    {0x0025, "\x54\x4c\x53\x5f\x4b\x52\x42\x35\x5f\x57\x49\x54\x48\x5f\x49\x44\x45\x41\x5f\x43\x42\x43\x5f\x4d\x44\x35"},
    {0x0026, "\x54\x4c\x53\x5f\x4b\x52\x42\x35\x5f\x45\x58\x50\x4f\x52\x54\x5f\x57\x49\x54\x48\x5f\x44\x45\x53\x5f\x43\x42\x43\x5f\x34\x30\x5f\x53\x48\x41"},
    {0x0027, "\x54\x4c\x53\x5f\x4b\x52\x42\x35\x5f\x45\x58\x50\x4f\x52\x54\x5f\x57\x49\x54\x48\x5f\x52\x43\x32\x5f\x43\x42\x43\x5f\x34\x30\x5f\x53\x48\x41"},
    {0x0028, "\x54\x4c\x53\x5f\x4b\x52\x42\x35\x5f\x45\x58\x50\x4f\x52\x54\x5f\x57\x49\x54\x48\x5f\x52\x43\x34\x5f\x34\x30\x5f\x53\x48\x41"},
    {0x0029, "\x54\x4c\x53\x5f\x4b\x52\x42\x35\x5f\x45\x58\x50\x4f\x52\x54\x5f\x57\x49\x54\x48\x5f\x44\x45\x53\x5f\x43\x42\x43\x5f\x34\x30\x5f\x4d\x44\x35"},
    {0x002A, "\x54\x4c\x53\x5f\x4b\x52\x42\x35\x5f\x45\x58\x50\x4f\x52\x54\x5f\x57\x49\x54\x48\x5f\x52\x43\x32\x5f\x43\x42\x43\x5f\x34\x30\x5f\x4d\x44\x35"},
    {0x002B, "\x54\x4c\x53\x5f\x4b\x52\x42\x35\x5f\x45\x58\x50\x4f\x52\x54\x5f\x57\x49\x54\x48\x5f\x52\x43\x34\x5f\x34\x30\x5f\x4d\x44\x35"},
    {0x002F, "\x54\x4c\x53\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0030, "\x54\x4c\x53\x5f\x44\x48\x5f\x44\x53\x53\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0031, "\x54\x4c\x53\x5f\x44\x48\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0032, "\x54\x4c\x53\x5f\x44\x48\x45\x5f\x44\x53\x53\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0033, "\x54\x4c\x53\x5f\x44\x48\x45\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0034, "\x54\x4c\x53\x5f\x44\x48\x5f\x61\x6e\x6f\x6e\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0035, "\x54\x4c\x53\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0036, "\x54\x4c\x53\x5f\x44\x48\x5f\x44\x53\x53\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0037, "\x54\x4c\x53\x5f\x44\x48\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0038, "\x54\x4c\x53\x5f\x44\x48\x45\x5f\x44\x53\x53\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0039, "\x54\x4c\x53\x5f\x44\x48\x45\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x003A, "\x54\x4c\x53\x5f\x44\x48\x5f\x61\x6e\x6f\x6e\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x003B, "\x54\x4c\x53\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x4e\x55\x4c\x4c\x5f\x53\x48\x41\x32\x35\x36"},
    {0x003C, "\x54\x4c\x53\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41\x32\x35\x36"},
    {0x003D, "\x54\x4c\x53\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41\x32\x35\x36"},
    {0x003E, "\x54\x4c\x53\x5f\x44\x48\x5f\x44\x53\x53\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41\x32\x35\x36"},
    {0x003F, "\x54\x4c\x53\x5f\x44\x48\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41\x32\x35\x36"},
    {0x0040, "\x54\x4c\x53\x5f\x44\x48\x45\x5f\x44\x53\x53\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41\x32\x35\x36"},
    {0x0041, "\x54\x4c\x53\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x43\x41\x4d\x45\x4c\x4c\x49\x41\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0042, "\x54\x4c\x53\x5f\x44\x48\x5f\x44\x53\x53\x5f\x57\x49\x54\x48\x5f\x43\x41\x4d\x45\x4c\x4c\x49\x41\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0043, "\x54\x4c\x53\x5f\x44\x48\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x43\x41\x4d\x45\x4c\x4c\x49\x41\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0044, "\x54\x4c\x53\x5f\x44\x48\x45\x5f\x44\x53\x53\x5f\x57\x49\x54\x48\x5f\x43\x41\x4d\x45\x4c\x4c\x49\x41\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0045, "\x54\x4c\x53\x5f\x44\x48\x45\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x43\x41\x4d\x45\x4c\x4c\x49\x41\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0046, "\x54\x4c\x53\x5f\x44\x48\x5f\x61\x6e\x6f\x6e\x5f\x57\x49\x54\x48\x5f\x43\x41\x4d\x45\x4c\x4c\x49\x41\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0067, "\x54\x4c\x53\x5f\x44\x48\x45\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41\x32\x35\x36"},
    {0x0068, "\x54\x4c\x53\x5f\x44\x48\x5f\x44\x53\x53\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41\x32\x35\x36"},
    {0x0069, "\x54\x4c\x53\x5f\x44\x48\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41\x32\x35\x36"},
    {0x006A, "\x54\x4c\x53\x5f\x44\x48\x45\x5f\x44\x53\x53\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41\x32\x35\x36"},
    {0x006B, "\x54\x4c\x53\x5f\x44\x48\x45\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41\x32\x35\x36"},
    {0x006C, "\x54\x4c\x53\x5f\x44\x48\x5f\x61\x6e\x6f\x6e\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41\x32\x35\x36"},
    {0x006D, "\x54\x4c\x53\x5f\x44\x48\x5f\x61\x6e\x6f\x6e\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41\x32\x35\x36"},
    {0x0084, "\x54\x4c\x53\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x43\x41\x4d\x45\x4c\x4c\x49\x41\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0085, "\x54\x4c\x53\x5f\x44\x48\x5f\x44\x53\x53\x5f\x57\x49\x54\x48\x5f\x43\x41\x4d\x45\x4c\x4c\x49\x41\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0086, "\x54\x4c\x53\x5f\x44\x48\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x43\x41\x4d\x45\x4c\x4c\x49\x41\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0087, "\x54\x4c\x53\x5f\x44\x48\x45\x5f\x44\x53\x53\x5f\x57\x49\x54\x48\x5f\x43\x41\x4d\x45\x4c\x4c\x49\x41\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0088, "\x54\x4c\x53\x5f\x44\x48\x45\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x43\x41\x4d\x45\x4c\x4c\x49\x41\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0089, "\x54\x4c\x53\x5f\x44\x48\x5f\x61\x6e\x6f\x6e\x5f\x57\x49\x54\x48\x5f\x43\x41\x4d\x45\x4c\x4c\x49\x41\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x008A, "\x54\x4c\x53\x5f\x50\x53\x4b\x5f\x57\x49\x54\x48\x5f\x52\x43\x34\x5f\x31\x32\x38\x5f\x53\x48\x41"},
    {0x008B, "\x54\x4c\x53\x5f\x50\x53\x4b\x5f\x57\x49\x54\x48\x5f\x33\x44\x45\x53\x5f\x45\x44\x45\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x008C, "\x54\x4c\x53\x5f\x50\x53\x4b\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x008D, "\x54\x4c\x53\x5f\x50\x53\x4b\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x008E, "\x54\x4c\x53\x5f\x44\x48\x45\x5f\x50\x53\x4b\x5f\x57\x49\x54\x48\x5f\x52\x43\x34\x5f\x31\x32\x38\x5f\x53\x48\x41"},
    {0x008F, "\x54\x4c\x53\x5f\x44\x48\x45\x5f\x50\x53\x4b\x5f\x57\x49\x54\x48\x5f\x33\x44\x45\x53\x5f\x45\x44\x45\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0090, "\x54\x4c\x53\x5f\x44\x48\x45\x5f\x50\x53\x4b\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0091, "\x54\x4c\x53\x5f\x44\x48\x45\x5f\x50\x53\x4b\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0092, "\x54\x4c\x53\x5f\x52\x53\x41\x5f\x50\x53\x4b\x5f\x57\x49\x54\x48\x5f\x52\x43\x34\x5f\x31\x32\x38\x5f\x53\x48\x41"},
    {0x0093, "\x54\x4c\x53\x5f\x52\x53\x41\x5f\x50\x53\x4b\x5f\x57\x49\x54\x48\x5f\x33\x44\x45\x53\x5f\x45\x44\x45\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0094, "\x54\x4c\x53\x5f\x52\x53\x41\x5f\x50\x53\x4b\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0095, "\x54\x4c\x53\x5f\x52\x53\x41\x5f\x50\x53\x4b\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0096, "\x54\x4c\x53\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x53\x45\x45\x44\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0097, "\x54\x4c\x53\x5f\x44\x48\x5f\x44\x53\x53\x5f\x57\x49\x54\x48\x5f\x53\x45\x45\x44\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0098, "\x54\x4c\x53\x5f\x44\x48\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x53\x45\x45\x44\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x0099, "\x54\x4c\x53\x5f\x44\x48\x45\x5f\x44\x53\x53\x5f\x57\x49\x54\x48\x5f\x53\x45\x45\x44\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x009A, "\x54\x4c\x53\x5f\x44\x48\x45\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x53\x45\x45\x44\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x009B, "\x54\x4c\x53\x5f\x44\x48\x5f\x61\x6e\x6f\x6e\x5f\x57\x49\x54\x48\x5f\x53\x45\x45\x44\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0x009C, "\x54\x4c\x53\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x47\x43\x4d\x5f\x53\x48\x41\x32\x35\x36"},
    {0x009D, "\x54\x4c\x53\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x47\x43\x4d\x5f\x53\x48\x41\x33\x38\x34"},
    {0x009E, "\x54\x4c\x53\x5f\x44\x48\x45\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x47\x43\x4d\x5f\x53\x48\x41\x32\x35\x36"},
    {0x009F, "\x54\x4c\x53\x5f\x44\x48\x45\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x47\x43\x4d\x5f\x53\x48\x41\x33\x38\x34"},
    {0x00A0, "\x54\x4c\x53\x5f\x44\x48\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x47\x43\x4d\x5f\x53\x48\x41\x32\x35\x36"},
    {0x00A1, "\x54\x4c\x53\x5f\x44\x48\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x47\x43\x4d\x5f\x53\x48\x41\x33\x38\x34"},
    {0x00A2, "\x54\x4c\x53\x5f\x44\x48\x45\x5f\x44\x53\x53\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x47\x43\x4d\x5f\x53\x48\x41\x32\x35\x36"},
    {0x00A3, "\x54\x4c\x53\x5f\x44\x48\x45\x5f\x44\x53\x53\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x47\x43\x4d\x5f\x53\x48\x41\x33\x38\x34"},
    {0x00A4, "\x54\x4c\x53\x5f\x44\x48\x5f\x44\x53\x53\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x47\x43\x4d\x5f\x53\x48\x41\x32\x35\x36"},
    {0x00A5, "\x54\x4c\x53\x5f\x44\x48\x5f\x44\x53\x53\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x47\x43\x4d\x5f\x53\x48\x41\x33\x38\x34"},
    {0x00A6, "\x54\x4c\x53\x5f\x44\x48\x5f\x61\x6e\x6f\x6e\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x47\x43\x4d\x5f\x53\x48\x41\x32\x35\x36"},
    {0x00A7, "\x54\x4c\x53\x5f\x44\x48\x5f\x61\x6e\x6f\x6e\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x47\x43\x4d\x5f\x53\x48\x41\x33\x38\x34"},
    {0x00A8, "\x54\x4c\x53\x5f\x50\x53\x4b\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x47\x43\x4d\x5f\x53\x48\x41\x32\x35\x36"},
    {0x00A9, "\x54\x4c\x53\x5f\x50\x53\x4b\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x47\x43\x4d\x5f\x53\x48\x41\x33\x38\x34"},
    {0x00AA, "\x54\x4c\x53\x5f\x44\x48\x45\x5f\x50\x53\x4b\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x47\x43\x4d\x5f\x53\x48\x41\x32\x35\x36"},
    {0x00AB, "\x54\x4c\x53\x5f\x44\x48\x45\x5f\x50\x53\x4b\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x47\x43\x4d\x5f\x53\x48\x41\x33\x38\x34"},
    {0x00AC, "\x54\x4c\x53\x5f\x52\x53\x41\x5f\x50\x53\x4b\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x47\x43\x4d\x5f\x53\x48\x41\x32\x35\x36"},
    {0x00AD, "\x54\x4c\x53\x5f\x52\x53\x41\x5f\x50\x53\x4b\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x47\x43\x4d\x5f\x53\x48\x41\x33\x38\x34"},
    {0x00AE, "\x54\x4c\x53\x5f\x50\x53\x4b\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41\x32\x35\x36"},
    {0x00AF, "\x54\x4c\x53\x5f\x50\x53\x4b\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41\x33\x38\x34"},
    {0x00B0, "\x54\x4c\x53\x5f\x50\x53\x4b\x5f\x57\x49\x54\x48\x5f\x4e\x55\x4c\x4c\x5f\x53\x48\x41\x32\x35\x36"},
    {0x00B1, "\x54\x4c\x53\x5f\x50\x53\x4b\x5f\x57\x49\x54\x48\x5f\x4e\x55\x4c\x4c\x5f\x53\x48\x41\x33\x38\x34"},
    {0x00B2, "\x54\x4c\x53\x5f\x44\x48\x45\x5f\x50\x53\x4b\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41\x32\x35\x36"},
    {0x00B3, "\x54\x4c\x53\x5f\x44\x48\x45\x5f\x50\x53\x4b\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41\x33\x38\x34"},
    {0x00B4, "\x54\x4c\x53\x5f\x44\x48\x45\x5f\x50\x53\x4b\x5f\x57\x49\x54\x48\x5f\x4e\x55\x4c\x4c\x5f\x53\x48\x41\x32\x35\x36"},
    {0x00B5, "\x54\x4c\x53\x5f\x44\x48\x45\x5f\x50\x53\x4b\x5f\x57\x49\x54\x48\x5f\x4e\x55\x4c\x4c\x5f\x53\x48\x41\x33\x38\x34"},
    {0x00B6, "\x54\x4c\x53\x5f\x52\x53\x41\x5f\x50\x53\x4b\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41\x32\x35\x36"},
    {0x00B7, "\x54\x4c\x53\x5f\x52\x53\x41\x5f\x50\x53\x4b\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41\x33\x38\x34"},
    {0x00B8, "\x54\x4c\x53\x5f\x52\x53\x41\x5f\x50\x53\x4b\x5f\x57\x49\x54\x48\x5f\x4e\x55\x4c\x4c\x5f\x53\x48\x41\x32\x35\x36"},
    {0x00B9, "\x54\x4c\x53\x5f\x52\x53\x41\x5f\x50\x53\x4b\x5f\x57\x49\x54\x48\x5f\x4e\x55\x4c\x4c\x5f\x53\x48\x41\x33\x38\x34"},
    {0x00BA, "\x54\x4c\x53\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x43\x41\x4d\x45\x4c\x4c\x49\x41\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41\x32\x35\x36"},
    {0x00BB, "\x54\x4c\x53\x5f\x44\x48\x5f\x44\x53\x53\x5f\x57\x49\x54\x48\x5f\x43\x41\x4d\x45\x4c\x4c\x49\x41\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41\x32\x35\x36"},
    {0x00BC, "\x54\x4c\x53\x5f\x44\x48\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x43\x41\x4d\x45\x4c\x4c\x49\x41\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41\x32\x35\x36"},
    {0x00BD, "\x54\x4c\x53\x5f\x44\x48\x45\x5f\x44\x53\x53\x5f\x57\x49\x54\x48\x5f\x43\x41\x4d\x45\x4c\x4c\x49\x41\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41\x32\x35\x36"},
    {0x00BE, "\x54\x4c\x53\x5f\x44\x48\x45\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x43\x41\x4d\x45\x4c\x4c\x49\x41\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41\x32\x35\x36"},
    {0x00BF, "\x54\x4c\x53\x5f\x44\x48\x5f\x61\x6e\x6f\x6e\x5f\x57\x49\x54\x48\x5f\x43\x41\x4d\x45\x4c\x4c\x49\x41\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41\x32\x35\x36"},
    {0x00C0, "\x54\x4c\x53\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x43\x41\x4d\x45\x4c\x4c\x49\x41\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41\x32\x35\x36"},
    {0x00C1, "\x54\x4c\x53\x5f\x44\x48\x5f\x44\x53\x53\x5f\x57\x49\x54\x48\x5f\x43\x41\x4d\x45\x4c\x4c\x49\x41\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41\x32\x35\x36"},
    {0x00C2, "\x54\x4c\x53\x5f\x44\x48\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x43\x41\x4d\x45\x4c\x4c\x49\x41\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41\x32\x35\x36"},
    {0x00C3, "\x54\x4c\x53\x5f\x44\x48\x45\x5f\x44\x53\x53\x5f\x57\x49\x54\x48\x5f\x43\x41\x4d\x45\x4c\x4c\x49\x41\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41\x32\x35\x36"},
    {0x00C4, "\x54\x4c\x53\x5f\x44\x48\x45\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x43\x41\x4d\x45\x4c\x4c\x49\x41\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41\x32\x35\x36"},
    {0x00C5, "\x54\x4c\x53\x5f\x44\x48\x5f\x61\x6e\x6f\x6e\x5f\x57\x49\x54\x48\x5f\x43\x41\x4d\x45\x4c\x4c\x49\x41\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41\x32\x35\x36"},
    {0x00FF, "\x54\x4c\x53\x5f\x45\x4d\x50\x54\x59\x5f\x52\x45\x4e\x45\x47\x4f\x54\x49\x41\x54\x49\x4f\x4e\x5f\x49\x4e\x46\x4f\x5f\x53\x43\x53\x56"},
    {0xC001, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x5f\x45\x43\x44\x53\x41\x5f\x57\x49\x54\x48\x5f\x4e\x55\x4c\x4c\x5f\x53\x48\x41"},
    {0xC002, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x5f\x45\x43\x44\x53\x41\x5f\x57\x49\x54\x48\x5f\x52\x43\x34\x5f\x31\x32\x38\x5f\x53\x48\x41"},
    {0xC003, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x5f\x45\x43\x44\x53\x41\x5f\x57\x49\x54\x48\x5f\x33\x44\x45\x53\x5f\x45\x44\x45\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0xC004, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x5f\x45\x43\x44\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0xC005, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x5f\x45\x43\x44\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0xC006, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x45\x5f\x45\x43\x44\x53\x41\x5f\x57\x49\x54\x48\x5f\x4e\x55\x4c\x4c\x5f\x53\x48\x41"},
    {0xC007, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x45\x5f\x45\x43\x44\x53\x41\x5f\x57\x49\x54\x48\x5f\x52\x43\x34\x5f\x31\x32\x38\x5f\x53\x48\x41"},
    {0xC008, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x45\x5f\x45\x43\x44\x53\x41\x5f\x57\x49\x54\x48\x5f\x33\x44\x45\x53\x5f\x45\x44\x45\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0xC009, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x45\x5f\x45\x43\x44\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0xC00A, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x45\x5f\x45\x43\x44\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0xC00B, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x4e\x55\x4c\x4c\x5f\x53\x48\x41"},
    {0xC00C, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x52\x43\x34\x5f\x31\x32\x38\x5f\x53\x48\x41"},
    {0xC00D, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x33\x44\x45\x53\x5f\x45\x44\x45\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0xC00E, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0xC00F, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0xC010, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x45\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x4e\x55\x4c\x4c\x5f\x53\x48\x41"},
    {0xC011, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x45\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x52\x43\x34\x5f\x31\x32\x38\x5f\x53\x48\x41"},
    {0xC012, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x45\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x33\x44\x45\x53\x5f\x45\x44\x45\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0xC013, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x45\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0xC014, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x45\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0xC015, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x5f\x61\x6e\x6f\x6e\x5f\x57\x49\x54\x48\x5f\x4e\x55\x4c\x4c\x5f\x53\x48\x41"},
    {0xC016, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x5f\x61\x6e\x6f\x6e\x5f\x57\x49\x54\x48\x5f\x52\x43\x34\x5f\x31\x32\x38\x5f\x53\x48\x41"},
    {0xC017, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x5f\x61\x6e\x6f\x6e\x5f\x57\x49\x54\x48\x5f\x33\x44\x45\x53\x5f\x45\x44\x45\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0xC018, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x5f\x61\x6e\x6f\x6e\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0xC019, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x5f\x61\x6e\x6f\x6e\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0xC01A, "\x54\x4c\x53\x5f\x53\x52\x50\x5f\x53\x48\x41\x5f\x57\x49\x54\x48\x5f\x33\x44\x45\x53\x5f\x45\x44\x45\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0xC01B, "\x54\x4c\x53\x5f\x53\x52\x50\x5f\x53\x48\x41\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x33\x44\x45\x53\x5f\x45\x44\x45\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0xC01C, "\x54\x4c\x53\x5f\x53\x52\x50\x5f\x53\x48\x41\x5f\x44\x53\x53\x5f\x57\x49\x54\x48\x5f\x33\x44\x45\x53\x5f\x45\x44\x45\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0xC01D, "\x54\x4c\x53\x5f\x53\x52\x50\x5f\x53\x48\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0xC01E, "\x54\x4c\x53\x5f\x53\x52\x50\x5f\x53\x48\x41\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0xC01F, "\x54\x4c\x53\x5f\x53\x52\x50\x5f\x53\x48\x41\x5f\x44\x53\x53\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0xC020, "\x54\x4c\x53\x5f\x53\x52\x50\x5f\x53\x48\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0xC021, "\x54\x4c\x53\x5f\x53\x52\x50\x5f\x53\x48\x41\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0xC022, "\x54\x4c\x53\x5f\x53\x52\x50\x5f\x53\x48\x41\x5f\x44\x53\x53\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0xC023, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x45\x5f\x45\x43\x44\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41\x32\x35\x36"},
    {0xC024, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x45\x5f\x45\x43\x44\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41\x33\x38\x34"},
    {0xC025, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x5f\x45\x43\x44\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41\x32\x35\x36"},
    {0xC026, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x5f\x45\x43\x44\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41\x33\x38\x34"},
    {0xC027, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x45\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41\x32\x35\x36"},
    {0xC028, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x45\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41\x33\x38\x34"},
    {0xC029, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x43\x42\x43\x5f\x53\x48\x41\x32\x35\x36"},
    {0xC02A, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x43\x42\x43\x5f\x53\x48\x41\x33\x38\x34"},
    {0xC02B, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x45\x5f\x45\x43\x44\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x47\x43\x4d\x5f\x53\x48\x41\x32\x35\x36"},
    {0xC02C, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x45\x5f\x45\x43\x44\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x47\x43\x4d\x5f\x53\x48\x41\x33\x38\x34"},
    {0xC02D, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x5f\x45\x43\x44\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x47\x43\x4d\x5f\x53\x48\x41\x32\x35\x36"},
    {0xC02E, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x5f\x45\x43\x44\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x47\x43\x4d\x5f\x53\x48\x41\x33\x38\x34"},
    {0xC02F, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x45\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x47\x43\x4d\x5f\x53\x48\x41\x32\x35\x36"},
    {0xC030, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x45\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x47\x43\x4d\x5f\x53\x48\x41\x33\x38\x34"},
    {0xC031, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x31\x32\x38\x5f\x47\x43\x4d\x5f\x53\x48\x41\x32\x35\x36"},
    {0xC032, "\x54\x4c\x53\x5f\x45\x43\x44\x48\x5f\x52\x53\x41\x5f\x57\x49\x54\x48\x5f\x41\x45\x53\x5f\x32\x35\x36\x5f\x47\x43\x4d\x5f\x53\x48\x41\x33\x38\x34"},
    {0xFEFE, "\x53\x53\x4c\x5f\x52\x53\x41\x5f\x46\x49\x50\x53\x5f\x57\x49\x54\x48\x5f\x44\x45\x53\x5f\x43\x42\x43\x5f\x53\x48\x41"},
    {0xFEFF, "\x53\x53\x4c\x5f\x52\x53\x41\x5f\x46\x49\x50\x53\x5f\x57\x49\x54\x48\x5f\x33\x44\x45\x53\x5f\x45\x44\x45\x5f\x43\x42\x43\x5f\x53\x48\x41"},
};

/* Compression methods */
static ssl_trace_tbl ssl_comp_tbl[] = {
    {0x0000, "\x4e\x6f\x20\x43\x6f\x6d\x70\x72\x65\x73\x73\x69\x6f\x6e"},
    {0x0001, "\x5a\x6c\x69\x62\x20\x43\x6f\x6d\x70\x72\x65\x73\x73\x69\x6f\x6e"}
};

/* Extensions */
static ssl_trace_tbl ssl_exts_tbl[] = {
    {TLSEXT_TYPE_server_name, "\x73\x65\x72\x76\x65\x72\x5f\x6e\x61\x6d\x65"},
    {TLSEXT_TYPE_max_fragment_length, "\x6d\x61\x78\x5f\x66\x72\x61\x67\x6d\x65\x6e\x74\x5f\x6c\x65\x6e\x67\x74\x68"},
    {TLSEXT_TYPE_client_certificate_url, "\x63\x6c\x69\x65\x6e\x74\x5f\x63\x65\x72\x74\x69\x66\x69\x63\x61\x74\x65\x5f\x75\x72\x6c"},
    {TLSEXT_TYPE_trusted_ca_keys, "\x74\x72\x75\x73\x74\x65\x64\x5f\x63\x61\x5f\x6b\x65\x79\x73"},
    {TLSEXT_TYPE_truncated_hmac, "\x74\x72\x75\x6e\x63\x61\x74\x65\x64\x5f\x68\x6d\x61\x63"},
    {TLSEXT_TYPE_status_request, "\x73\x74\x61\x74\x75\x73\x5f\x72\x65\x71\x75\x65\x73\x74"},
    {TLSEXT_TYPE_user_mapping, "\x75\x73\x65\x72\x5f\x6d\x61\x70\x70\x69\x6e\x67"},
    {TLSEXT_TYPE_client_authz, "\x63\x6c\x69\x65\x6e\x74\x5f\x61\x75\x74\x68\x7a"},
    {TLSEXT_TYPE_server_authz, "\x73\x65\x72\x76\x65\x72\x5f\x61\x75\x74\x68\x7a"},
    {TLSEXT_TYPE_cert_type, "\x63\x65\x72\x74\x5f\x74\x79\x70\x65"},
    {TLSEXT_TYPE_elliptic_curves, "\x65\x6c\x6c\x69\x70\x74\x69\x63\x5f\x63\x75\x72\x76\x65\x73"},
    {TLSEXT_TYPE_ec_point_formats, "\x65\x63\x5f\x70\x6f\x69\x6e\x74\x5f\x66\x6f\x72\x6d\x61\x74\x73"},
    {TLSEXT_TYPE_srp, "\x73\x72\x70"},
    {TLSEXT_TYPE_signature_algorithms, "\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x5f\x61\x6c\x67\x6f\x72\x69\x74\x68\x6d\x73"},
    {TLSEXT_TYPE_use_srtp, "\x75\x73\x65\x5f\x73\x72\x74\x70"},
    {TLSEXT_TYPE_heartbeat, "\x68\x65\x61\x72\x74\x62\x65\x61\x74"},
    {TLSEXT_TYPE_session_ticket, "\x73\x65\x73\x73\x69\x6f\x6e\x5f\x74\x69\x63\x6b\x65\x74"},
# ifdef TLSEXT_TYPE_opaque_prf_input
    {TLSEXT_TYPE_opaque_prf_input, "\x6f\x70\x61\x71\x75\x65\x5f\x70\x72\x66\x5f\x69\x6e\x70\x75\x74"},
# endif
    {TLSEXT_TYPE_renegotiate, "\x72\x65\x6e\x65\x67\x6f\x74\x69\x61\x74\x65"},
    {TLSEXT_TYPE_next_proto_neg, "\x6e\x65\x78\x74\x5f\x70\x72\x6f\x74\x6f\x5f\x6e\x65\x67"},
    {TLSEXT_TYPE_padding, "\x70\x61\x64\x64\x69\x6e\x67"}
};

static ssl_trace_tbl ssl_curve_tbl[] = {
    {1, "\x73\x65\x63\x74\x31\x36\x33\x6b\x31\x20\x28\x4b\x2d\x31\x36\x33\x29"},
    {2, "\x73\x65\x63\x74\x31\x36\x33\x72\x31"},
    {3, "\x73\x65\x63\x74\x31\x36\x33\x72\x32\x20\x28\x42\x2d\x31\x36\x33\x29"},
    {4, "\x73\x65\x63\x74\x31\x39\x33\x72\x31"},
    {5, "\x73\x65\x63\x74\x31\x39\x33\x72\x32"},
    {6, "\x73\x65\x63\x74\x32\x33\x33\x6b\x31\x20\x28\x4b\x2d\x32\x33\x33\x29"},
    {7, "\x73\x65\x63\x74\x32\x33\x33\x72\x31\x20\x28\x42\x2d\x32\x33\x33\x29"},
    {8, "\x73\x65\x63\x74\x32\x33\x39\x6b\x31"},
    {9, "\x73\x65\x63\x74\x32\x38\x33\x6b\x31\x20\x28\x4b\x2d\x32\x38\x33\x29"},
    {10, "\x73\x65\x63\x74\x32\x38\x33\x72\x31\x20\x28\x42\x2d\x32\x38\x33\x29"},
    {11, "\x73\x65\x63\x74\x34\x30\x39\x6b\x31\x20\x28\x4b\x2d\x34\x30\x39\x29"},
    {12, "\x73\x65\x63\x74\x34\x30\x39\x72\x31\x20\x28\x42\x2d\x34\x30\x39\x29"},
    {13, "\x73\x65\x63\x74\x35\x37\x31\x6b\x31\x20\x28\x4b\x2d\x35\x37\x31\x29"},
    {14, "\x73\x65\x63\x74\x35\x37\x31\x72\x31\x20\x28\x42\x2d\x35\x37\x31\x29"},
    {15, "\x73\x65\x63\x70\x31\x36\x30\x6b\x31"},
    {16, "\x73\x65\x63\x70\x31\x36\x30\x72\x31"},
    {17, "\x73\x65\x63\x70\x31\x36\x30\x72\x32"},
    {18, "\x73\x65\x63\x70\x31\x39\x32\x6b\x31"},
    {19, "\x73\x65\x63\x70\x31\x39\x32\x72\x31\x20\x28\x50\x2d\x31\x39\x32\x29"},
    {20, "\x73\x65\x63\x70\x32\x32\x34\x6b\x31"},
    {21, "\x73\x65\x63\x70\x32\x32\x34\x72\x31\x20\x28\x50\x2d\x32\x32\x34\x29"},
    {22, "\x73\x65\x63\x70\x32\x35\x36\x6b\x31"},
    {23, "\x73\x65\x63\x70\x32\x35\x36\x72\x31\x20\x28\x50\x2d\x32\x35\x36\x29"},
    {24, "\x73\x65\x63\x70\x33\x38\x34\x72\x31\x20\x28\x50\x2d\x33\x38\x34\x29"},
    {25, "\x73\x65\x63\x70\x35\x32\x31\x72\x31\x20\x28\x50\x2d\x35\x32\x31\x29"},
    {26, "\x62\x72\x61\x69\x6e\x70\x6f\x6f\x6c\x50\x32\x35\x36\x72\x31"},
    {27, "\x62\x72\x61\x69\x6e\x70\x6f\x6f\x6c\x50\x33\x38\x34\x72\x31"},
    {28, "\x62\x72\x61\x69\x6e\x70\x6f\x6f\x6c\x50\x35\x31\x32\x72\x31"},
    {0xFF01, "\x61\x72\x62\x69\x74\x72\x61\x72\x79\x5f\x65\x78\x70\x6c\x69\x63\x69\x74\x5f\x70\x72\x69\x6d\x65\x5f\x63\x75\x72\x76\x65\x73"},
    {0xFF02, "\x61\x72\x62\x69\x74\x72\x61\x72\x79\x5f\x65\x78\x70\x6c\x69\x63\x69\x74\x5f\x63\x68\x61\x72\x32\x5f\x63\x75\x72\x76\x65\x73"}
};

static ssl_trace_tbl ssl_point_tbl[] = {
    {0, "\x75\x6e\x63\x6f\x6d\x70\x72\x65\x73\x73\x65\x64"},
    {1, "\x61\x6e\x73\x69\x58\x39\x36\x32\x5f\x63\x6f\x6d\x70\x72\x65\x73\x73\x65\x64\x5f\x70\x72\x69\x6d\x65"},
    {2, "\x61\x6e\x73\x69\x58\x39\x36\x32\x5f\x63\x6f\x6d\x70\x72\x65\x73\x73\x65\x64\x5f\x63\x68\x61\x72\x32"}
};

static ssl_trace_tbl ssl_md_tbl[] = {
    {0, "\x6e\x6f\x6e\x65"},
    {1, "\x6d\x64\x35"},
    {2, "\x73\x68\x61\x31"},
    {3, "\x73\x68\x61\x32\x32\x34"},
    {4, "\x73\x68\x61\x32\x35\x36"},
    {5, "\x73\x68\x61\x33\x38\x34"},
    {6, "\x73\x68\x61\x35\x31\x32"}
};

static ssl_trace_tbl ssl_sig_tbl[] = {
    {0, "\x61\x6e\x6f\x6e\x79\x6d\x6f\x75\x73"},
    {1, "\x72\x73\x61"},
    {2, "\x64\x73\x61"},
    {3, "\x65\x63\x64\x73\x61"}
};

static ssl_trace_tbl ssl_hb_tbl[] = {
    {1, "\x70\x65\x65\x72\x5f\x61\x6c\x6c\x6f\x77\x65\x64\x5f\x74\x6f\x5f\x73\x65\x6e\x64"},
    {2, "\x70\x65\x65\x72\x5f\x6e\x6f\x74\x5f\x61\x6c\x6c\x6f\x77\x65\x64\x5f\x74\x6f\x5f\x73\x65\x6e\x64"}
};

static ssl_trace_tbl ssl_hb_type_tbl[] = {
    {1, "\x68\x65\x61\x72\x74\x62\x65\x61\x74\x5f\x72\x65\x71\x75\x65\x73\x74"},
    {2, "\x68\x65\x61\x72\x74\x62\x65\x61\x74\x5f\x72\x65\x73\x70\x6f\x6e\x73\x65"}
};

static ssl_trace_tbl ssl_ctype_tbl[] = {
    {1, "\x72\x73\x61\x5f\x73\x69\x67\x6e"},
    {2, "\x64\x73\x73\x5f\x73\x69\x67\x6e"},
    {3, "\x72\x73\x61\x5f\x66\x69\x78\x65\x64\x5f\x64\x68"},
    {4, "\x64\x73\x73\x5f\x66\x69\x78\x65\x64\x5f\x64\x68"},
    {5, "\x72\x73\x61\x5f\x65\x70\x68\x65\x6d\x65\x72\x61\x6c\x5f\x64\x68"},
    {6, "\x64\x73\x73\x5f\x65\x70\x68\x65\x6d\x65\x72\x61\x6c\x5f\x64\x68"},
    {20, "\x66\x6f\x72\x74\x65\x7a\x7a\x61\x5f\x64\x6d\x73"},
    {64, "\x65\x63\x64\x73\x61\x5f\x73\x69\x67\x6e"},
    {65, "\x72\x73\x61\x5f\x66\x69\x78\x65\x64\x5f\x65\x63\x64\x68"},
    {66, "\x65\x63\x64\x73\x61\x5f\x66\x69\x78\x65\x64\x5f\x65\x63\x64\x68"}
};

static ssl_trace_tbl ssl_crypto_tbl[] = {
    {TLS1_RT_CRYPTO_PREMASTER, "\x50\x72\x65\x6d\x61\x73\x74\x65\x72\x20\x53\x65\x63\x72\x65\x74"},
    {TLS1_RT_CRYPTO_CLIENT_RANDOM, "\x43\x6c\x69\x65\x6e\x74\x20\x52\x61\x6e\x64\x6f\x6d"},
    {TLS1_RT_CRYPTO_SERVER_RANDOM, "\x53\x65\x72\x76\x65\x72\x20\x52\x61\x6e\x64\x6f\x6d"},
    {TLS1_RT_CRYPTO_MASTER, "\x4d\x61\x73\x74\x65\x72\x20\x53\x65\x63\x72\x65\x74"},
    {TLS1_RT_CRYPTO_MAC | TLS1_RT_CRYPTO_WRITE, "\x57\x72\x69\x74\x65\x20\x4d\x61\x63\x20\x53\x65\x63\x72\x65\x74"},
    {TLS1_RT_CRYPTO_MAC | TLS1_RT_CRYPTO_READ, "\x52\x65\x61\x64\x20\x4d\x61\x63\x20\x53\x65\x63\x72\x65\x74"},
    {TLS1_RT_CRYPTO_KEY | TLS1_RT_CRYPTO_WRITE, "\x57\x72\x69\x74\x65\x20\x4b\x65\x79"},
    {TLS1_RT_CRYPTO_KEY | TLS1_RT_CRYPTO_READ, "\x52\x65\x61\x64\x20\x4b\x65\x79"},
    {TLS1_RT_CRYPTO_IV | TLS1_RT_CRYPTO_WRITE, "\x57\x72\x69\x74\x65\x20\x49\x56"},
    {TLS1_RT_CRYPTO_IV | TLS1_RT_CRYPTO_READ, "\x52\x65\x61\x64\x20\x49\x56"},
    {TLS1_RT_CRYPTO_FIXED_IV | TLS1_RT_CRYPTO_WRITE, "\x57\x72\x69\x74\x65\x20\x49\x56\x20\x28\x66\x69\x78\x65\x64\x20\x70\x61\x72\x74\x29"},
    {TLS1_RT_CRYPTO_FIXED_IV | TLS1_RT_CRYPTO_READ, "\x52\x65\x61\x64\x20\x49\x56\x20\x28\x66\x69\x78\x65\x64\x20\x70\x61\x72\x74\x29"}
};

static void ssl_print_hex(BIO *bio, int indent, const char *name,
                          const unsigned char *msg, size_t msglen)
{
    size_t i;
    BIO_indent(bio, indent, 80);
    BIO_printf(bio, "\x25\x73\x20\x28\x6c\x65\x6e\x3d\x25\x64\x29\x3a\x20", name, (int)msglen);
    for (i = 0; i < msglen; i++)
        BIO_printf(bio, "\x25\x30\x32\x58", msg[i]);
    BIO_puts(bio, "\xa");
}

static int ssl_print_hexbuf(BIO *bio, int indent,
                            const char *name, size_t nlen,
                            const unsigned char **pmsg, size_t *pmsglen)
{
    size_t blen;
    const unsigned char *p = *pmsg;
    if (*pmsglen < nlen)
        return 0;
    blen = p[0];
    if (nlen > 1)
        blen = (blen << 8) | p[1];
    if (*pmsglen < nlen + blen)
        return 0;
    p += nlen;
    ssl_print_hex(bio, indent, name, p, blen);
    *pmsg += blen + nlen;
    *pmsglen -= blen + nlen;
    return 1;
}

static int ssl_print_version(BIO *bio, int indent, const char *name,
                             const unsigned char **pmsg, size_t *pmsglen)
{
    int vers;
    if (*pmsglen < 2)
        return 0;
    vers = ((*pmsg)[0] << 8) | (*pmsg)[1];
    BIO_indent(bio, indent, 80);
    BIO_printf(bio, "\x25\x73\x3d\x30\x78\x25\x78\x20\x28\x25\x73\x29\xa",
               name, vers, ssl_trace_str(vers, ssl_version_tbl));
    *pmsg += 2;
    *pmsglen -= 2;
    return 1;
}

static int ssl_print_random(BIO *bio, int indent,
                            const unsigned char **pmsg, size_t *pmsglen)
{
    unsigned int tm;
    const unsigned char *p = *pmsg;
    if (*pmsglen < 32)
        return 0;
    tm = (p[0] << 24) | (p[1] << 16) | (p[2] << 8) | p[3];
    p += 4;
    BIO_indent(bio, indent, 80);
    BIO_puts(bio, "\x52\x61\x6e\x64\x6f\x6d\x3a\xa");
    BIO_indent(bio, indent + 2, 80);
    BIO_printf(bio, "\x67\x6d\x74\x5f\x75\x6e\x69\x78\x5f\x74\x69\x6d\x65\x3d\x30\x78\x25\x30\x38\x58\xa", tm);
    ssl_print_hex(bio, indent + 2, "\x72\x61\x6e\x64\x6f\x6d\x5f\x62\x79\x74\x65\x73", p, 28);
    *pmsg += 32;
    *pmsglen -= 32;
    return 1;
}

static int ssl_print_signature(BIO *bio, int indent, SSL *s,
                               const unsigned char **pmsg, size_t *pmsglen)
{
    if (*pmsglen < 2)
        return 0;
    if (SSL_USE_SIGALGS(s)) {
        const unsigned char *p = *pmsg;
        BIO_indent(bio, indent, 80);
        BIO_printf(bio, "\x53\x69\x67\x6e\x61\x74\x75\x72\x65\x20\x41\x6c\x67\x6f\x72\x69\x74\x68\x6d\x20\x25\x73\x2b\x25\x73\x20\x28\x25\x64\x2b\x25\x64\x29\xa",
                   ssl_trace_str(p[0], ssl_md_tbl),
                   ssl_trace_str(p[1], ssl_sig_tbl), p[0], p[1]);
        *pmsg += 2;
        *pmsglen -= 2;
    }
    return ssl_print_hexbuf(bio, indent, "\x53\x69\x67\x6e\x61\x74\x75\x72\x65", 2, pmsg, pmsglen);
}

static int ssl_print_extension(BIO *bio, int indent, int server, int extype,
                               const unsigned char *ext, size_t extlen)
{
    size_t xlen;
    BIO_indent(bio, indent, 80);
    BIO_printf(bio, "\x65\x78\x74\x65\x6e\x73\x69\x6f\x6e\x5f\x74\x79\x70\x65\x3d\x25\x73\x28\x25\x64\x29\x2c\x20\x6c\x65\x6e\x67\x74\x68\x3d\x25\x64\xa",
               ssl_trace_str(extype, ssl_exts_tbl), extype, (int)extlen);
    switch (extype) {
    case TLSEXT_TYPE_ec_point_formats:
        if (extlen < 1)
            return 0;
        xlen = ext[0];
        if (extlen != xlen + 1)
            return 0;
        return ssl_trace_list(bio, indent + 2,
                              ext + 1, xlen, 1, ssl_point_tbl);

    case TLSEXT_TYPE_elliptic_curves:
        if (extlen < 2)
            return 0;
        xlen = (ext[0] << 8) | ext[1];
        if (extlen != xlen + 2)
            return 0;
        return ssl_trace_list(bio, indent + 2,
                              ext + 2, xlen, 2, ssl_curve_tbl);

    case TLSEXT_TYPE_signature_algorithms:

        if (extlen < 2)
            return 0;
        xlen = (ext[0] << 8) | ext[1];
        if (extlen != xlen + 2)
            return 0;
        if (xlen & 1)
            return 0;
        ext += 2;
        while (xlen > 0) {
            BIO_indent(bio, indent + 2, 80);
            BIO_printf(bio, "\x25\x73\x2b\x25\x73\x20\x28\x25\x64\x2b\x25\x64\x29\xa",
                       ssl_trace_str(ext[0], ssl_md_tbl),
                       ssl_trace_str(ext[1], ssl_sig_tbl), ext[0], ext[1]);
            xlen -= 2;
            ext += 2;
        }
        break;

    case TLSEXT_TYPE_renegotiate:
        if (extlen < 1)
            return 0;
        xlen = ext[0];
        if (xlen + 1 != extlen)
            return 0;
        ext++;
        if (xlen) {
            if (server) {
                if (xlen & 1)
                    return 0;
                xlen >>= 1;
            }
            ssl_print_hex(bio, indent + 4, "\x63\x6c\x69\x65\x6e\x74\x5f\x76\x65\x72\x69\x66\x79\x5f\x64\x61\x74\x61", ext, xlen);
            if (server) {
                ext += xlen;
                ssl_print_hex(bio, indent + 4,
                              "\x73\x65\x72\x76\x65\x72\x5f\x76\x65\x72\x69\x66\x79\x5f\x64\x61\x74\x61", ext, xlen);
            }
        } else {
            BIO_indent(bio, indent + 4, 80);
            BIO_puts(bio, "\x3c\x45\x4d\x50\x54\x59\x3e\xa");
        }
        break;

    case TLSEXT_TYPE_heartbeat:
        if (extlen != 1)
            return 0;
        BIO_indent(bio, indent + 2, 80);
        BIO_printf(bio, "\x48\x65\x61\x72\x74\x62\x65\x61\x74\x4d\x6f\x64\x65\x3a\x20\x25\x73\xa",
                   ssl_trace_str(ext[0], ssl_hb_tbl));
        break;

    case TLSEXT_TYPE_session_ticket:
        if (extlen != 0)
            ssl_print_hex(bio, indent + 4, "\x74\x69\x63\x6b\x65\x74", ext, extlen);
        break;

    default:
        BIO_dump_indent(bio, (char *)ext, extlen, indent + 2);
    }
    return 1;
}

static int ssl_print_extensions(BIO *bio, int indent, int server,
                                const unsigned char *msg, size_t msglen)
{
    size_t extslen;
    BIO_indent(bio, indent, 80);
    if (msglen == 0) {
        BIO_puts(bio, "\x4e\x6f\x20\x45\x78\x74\x65\x6e\x73\x69\x6f\x6e\x73\xa");
        return 1;
    }
    extslen = (msg[0] << 8) | msg[1];
    if (extslen != msglen - 2)
        return 0;
    msg += 2;
    msglen = extslen;
    BIO_printf(bio, "\x65\x78\x74\x65\x6e\x73\x69\x6f\x6e\x73\x2c\x20\x6c\x65\x6e\x67\x74\x68\x20\x3d\x20\x25\x64\xa", (int)msglen);
    while (msglen > 0) {
        int extype;
        size_t extlen;
        if (msglen < 4)
            return 0;
        extype = (msg[0] << 8) | msg[1];
        extlen = (msg[2] << 8) | msg[3];
        if (msglen < extlen + 4)
            return 0;
        msg += 4;
        if (!ssl_print_extension(bio, indent + 2, server,
                                 extype, msg, extlen))
            return 0;
        msg += extlen;
        msglen -= extlen + 4;
    }
    return 1;
}

static int ssl_print_client_hello(BIO *bio, SSL *ssl, int indent,
                                  const unsigned char *msg, size_t msglen)
{
    size_t len;
    unsigned int cs;
    if (!ssl_print_version(bio, indent, "\x63\x6c\x69\x65\x6e\x74\x5f\x76\x65\x72\x73\x69\x6f\x6e", &msg, &msglen))
        return 0;
    if (!ssl_print_random(bio, indent, &msg, &msglen))
        return 0;
    if (!ssl_print_hexbuf(bio, indent, "\x73\x65\x73\x73\x69\x6f\x6e\x5f\x69\x64", 1, &msg, &msglen))
        return 0;
    if (SSL_IS_DTLS(ssl)) {
        if (!ssl_print_hexbuf(bio, indent, "\x63\x6f\x6f\x6b\x69\x65", 1, &msg, &msglen))
            return 0;
    }
    if (msglen < 2)
        return 0;
    len = (msg[0] << 8) | msg[1];
    msg += 2;
    msglen -= 2;
    BIO_indent(bio, indent, 80);
    BIO_printf(bio, "\x63\x69\x70\x68\x65\x72\x5f\x73\x75\x69\x74\x65\x73\x20\x28\x6c\x65\x6e\x3d\x25\x64\x29\xa", (int)len);
    if (msglen < len || len & 1)
        return 0;
    while (len > 0) {
        cs = (msg[0] << 8) | msg[1];
        BIO_indent(bio, indent + 2, 80);
        BIO_printf(bio, "\x7b\x30\x78\x25\x30\x32\x58\x2c\x20\x30\x78\x25\x30\x32\x58\x7d\x20\x25\x73\xa",
                   msg[0], msg[1], ssl_trace_str(cs, ssl_ciphers_tbl));
        msg += 2;
        msglen -= 2;
        len -= 2;
    }
    if (msglen < 1)
        return 0;
    len = msg[0];
    msg++;
    msglen--;
    if (msglen < len)
        return 0;
    BIO_indent(bio, indent, 80);
    BIO_printf(bio, "\x63\x6f\x6d\x70\x72\x65\x73\x73\x69\x6f\x6e\x5f\x6d\x65\x74\x68\x6f\x64\x73\x20\x28\x6c\x65\x6e\x3d\x25\x64\x29\xa", (int)len);
    while (len > 0) {
        BIO_indent(bio, indent + 2, 80);
        BIO_printf(bio, "\x25\x73\x20\x28\x30\x78\x25\x30\x32\x58\x29\xa",
                   ssl_trace_str(msg[0], ssl_comp_tbl), msg[0]);
        msg++;
        msglen--;
        len--;
    }
    if (!ssl_print_extensions(bio, indent, 0, msg, msglen))
        return 0;
    return 1;
}

static int dtls_print_hello_vfyrequest(BIO *bio, int indent,
                                       const unsigned char *msg,
                                       size_t msglen)
{
    if (!ssl_print_version(bio, indent, "\x73\x65\x72\x76\x65\x72\x5f\x76\x65\x72\x73\x69\x6f\x6e", &msg, &msglen))
        return 0;
    if (!ssl_print_hexbuf(bio, indent, "\x63\x6f\x6f\x6b\x69\x65", 1, &msg, &msglen))
        return 0;
    return 1;
}

static int ssl_print_server_hello(BIO *bio, int indent,
                                  const unsigned char *msg, size_t msglen)
{
    unsigned int cs;
    if (!ssl_print_version(bio, indent, "\x73\x65\x72\x76\x65\x72\x5f\x76\x65\x72\x73\x69\x6f\x6e", &msg, &msglen))
        return 0;
    if (!ssl_print_random(bio, indent, &msg, &msglen))
        return 0;
    if (!ssl_print_hexbuf(bio, indent, "\x73\x65\x73\x73\x69\x6f\x6e\x5f\x69\x64", 1, &msg, &msglen))
        return 0;
    if (msglen < 2)
        return 0;
    cs = (msg[0] << 8) | msg[1];
    BIO_indent(bio, indent, 80);
    BIO_printf(bio, "\x63\x69\x70\x68\x65\x72\x5f\x73\x75\x69\x74\x65\x20\x7b\x30\x78\x25\x30\x32\x58\x2c\x20\x30\x78\x25\x30\x32\x58\x7d\x20\x25\x73\xa",
               msg[0], msg[1], ssl_trace_str(cs, ssl_ciphers_tbl));
    msg += 2;
    msglen -= 2;
    if (msglen < 1)
        return 0;
    BIO_indent(bio, indent, 80);
    BIO_printf(bio, "\x63\x6f\x6d\x70\x72\x65\x73\x73\x69\x6f\x6e\x5f\x6d\x65\x74\x68\x6f\x64\x3a\x20\x25\x73\x20\x28\x30\x78\x25\x30\x32\x58\x29\xa",
               ssl_trace_str(msg[0], ssl_comp_tbl), msg[0]);
    msg++;
    msglen--;
    if (!ssl_print_extensions(bio, indent, 1, msg, msglen))
        return 0;
    return 1;
}

static int ssl_get_keyex(const char **pname, SSL *ssl)
{
    unsigned long alg_k = ssl->s3->tmp.new_cipher->algorithm_mkey;
    if (alg_k & SSL_kRSA) {
        *pname = "\x72\x73\x61";
        return SSL_kRSA;
    }
    if (alg_k & SSL_kDHr) {
        *pname = "\x64\x68\x5f\x72\x73\x61";
        return SSL_kDHr;
    }
    if (alg_k & SSL_kDHd) {
        *pname = "\x64\x68\x5f\x64\x73\x73";
        return SSL_kDHd;
    }
    if (alg_k & SSL_kKRB5) {
        *pname = "\x6b\x72\x62\x35";
        return SSL_kKRB5;
    }
    if (alg_k & SSL_kEDH) {
        *pname = "\x65\x64\x68";
        return SSL_kEDH;
    }
    if (alg_k & SSL_kEECDH) {
        *pname = "\x45\x45\x43\x44\x48";
        return SSL_kEECDH;
    }
    if (alg_k & SSL_kECDHr) {
        *pname = "\x45\x43\x44\x48\x20\x52\x53\x41";
        return SSL_kECDHr;
    }
    if (alg_k & SSL_kECDHe) {
        *pname = "\x45\x43\x44\x48\x20\x45\x43\x44\x53\x41";
        return SSL_kECDHe;
    }
    if (alg_k & SSL_kPSK) {
        *pname = "\x50\x53\x4b";
        return SSL_kPSK;
    }
    if (alg_k & SSL_kSRP) {
        *pname = "\x53\x52\x50";
        return SSL_kSRP;
    }
    if (alg_k & SSL_kGOST) {
        *pname = "\x47\x4f\x53\x54";
        return SSL_kGOST;
    }
    *pname = "\x55\x4e\x4b\x4e\x4f\x57\x4e";
    return 0;
}

static int ssl_print_client_keyex(BIO *bio, int indent, SSL *ssl,
                                  const unsigned char *msg, size_t msglen)
{
    const char *algname;
    int id;
    id = ssl_get_keyex(&algname, ssl);
    BIO_indent(bio, indent, 80);
    BIO_printf(bio, "\x4b\x65\x79\x45\x78\x63\x68\x61\x6e\x67\x65\x41\x6c\x67\x6f\x72\x69\x74\x68\x6d\x3d\x25\x73\xa", algname);
    switch (id) {

    case SSL_kRSA:
        if (TLS1_get_version(ssl) == SSL3_VERSION) {
            ssl_print_hex(bio, indent + 2,
                          "\x45\x6e\x63\x79\x70\x74\x65\x64\x50\x72\x65\x4d\x61\x73\x74\x65\x72\x53\x65\x63\x72\x65\x74", msg, msglen);
        } else {
            if (!ssl_print_hexbuf(bio, indent + 2,
                                  "\x45\x6e\x63\x79\x70\x74\x65\x64\x50\x72\x65\x4d\x61\x73\x74\x65\x72\x53\x65\x63\x72\x65\x74", 2,
                                  &msg, &msglen))
                return 0;
        }
        break;

        /* Implicit parameters only allowed for static DH */
    case SSL_kDHd:
    case SSL_kDHr:
        if (msglen == 0) {
            BIO_indent(bio, indent + 2, 80);
            BIO_puts(bio, "\x69\x6d\x70\x6c\x69\x63\x69\x74\xa");
            break;
        }
    case SSL_kEDH:
        if (!ssl_print_hexbuf(bio, indent + 2, "\x64\x68\x5f\x59\x63", 2, &msg, &msglen))
            return 0;
        break;

    case SSL_kECDHr:
    case SSL_kECDHe:
        if (msglen == 0) {
            BIO_indent(bio, indent + 2, 80);
            BIO_puts(bio, "\x69\x6d\x70\x6c\x69\x63\x69\x74\xa");
            break;
        }
    case SSL_kEECDH:
        if (!ssl_print_hexbuf(bio, indent + 2, "\x65\x63\x64\x68\x5f\x59\x63", 1, &msg, &msglen))
            return 0;
        break;
    }

    return 1;
}

static int ssl_print_server_keyex(BIO *bio, int indent, SSL *ssl,
                                  const unsigned char *msg, size_t msglen)
{
    const char *algname;
    int id;
    id = ssl_get_keyex(&algname, ssl);
    BIO_indent(bio, indent, 80);
    BIO_printf(bio, "\x4b\x65\x79\x45\x78\x63\x68\x61\x6e\x67\x65\x41\x6c\x67\x6f\x72\x69\x74\x68\x6d\x3d\x25\x73\xa", algname);
    switch (id) {
        /* Should never happen */
    case SSL_kDHd:
    case SSL_kDHr:
    case SSL_kECDHr:
    case SSL_kECDHe:
        BIO_indent(bio, indent + 2, 80);
        BIO_printf(bio, "\x55\x6e\x65\x78\x70\x65\x63\x74\x65\x64\x20\x4d\x65\x73\x73\x61\x67\x65\xa");
        break;

    case SSL_kRSA:

        if (!ssl_print_hexbuf(bio, indent + 2, "\x72\x73\x61\x5f\x6d\x6f\x64\x75\x6c\x75\x73", 2,
                              &msg, &msglen))
            return 0;
        if (!ssl_print_hexbuf(bio, indent + 2, "\x72\x73\x61\x5f\x65\x78\x70\x6f\x6e\x65\x6e\x74", 2,
                              &msg, &msglen))
            return 0;
        break;

    case SSL_kEDH:
        if (!ssl_print_hexbuf(bio, indent + 2, "\x64\x68\x5f\x70", 2, &msg, &msglen))
            return 0;
        if (!ssl_print_hexbuf(bio, indent + 2, "\x64\x68\x5f\x67", 2, &msg, &msglen))
            return 0;
        if (!ssl_print_hexbuf(bio, indent + 2, "\x64\x68\x5f\x59\x73", 2, &msg, &msglen))
            return 0;
        break;

    case SSL_kEECDH:
        if (msglen < 1)
            return 0;
        BIO_indent(bio, indent + 2, 80);
        if (msg[0] == EXPLICIT_PRIME_CURVE_TYPE)
            BIO_puts(bio, "\x65\x78\x70\x6c\x69\x63\x69\x74\x5f\x70\x72\x69\x6d\x65\xa");
        else if (msg[0] == EXPLICIT_CHAR2_CURVE_TYPE)
            BIO_puts(bio, "\x65\x78\x70\x6c\x69\x63\x69\x74\x5f\x63\x68\x61\x72\x32\xa");
        else if (msg[0] == NAMED_CURVE_TYPE) {
            int curve;
            if (msglen < 3)
                return 0;
            curve = (msg[1] << 8) | msg[2];
            BIO_printf(bio, "\x6e\x61\x6d\x65\x64\x5f\x63\x75\x72\x76\x65\x3a\x20\x25\x73\x20\x28\x25\x64\x29\xa",
                       ssl_trace_str(curve, ssl_curve_tbl), curve);
            msg += 3;
            msglen -= 3;
            if (!ssl_print_hexbuf(bio, indent + 2, "\x70\x6f\x69\x6e\x74", 1, &msg, &msglen))
                return 0;
        }
        break;
    }
    return ssl_print_signature(bio, indent, ssl, &msg, &msglen);
}

static int ssl_print_certificate(BIO *bio, int indent,
                                 const unsigned char **pmsg, size_t *pmsglen)
{
    size_t msglen = *pmsglen;
    size_t clen;
    X509 *x;
    const unsigned char *p = *pmsg, *q;
    if (msglen < 3)
        return 0;
    clen = (p[0] << 16) | (p[1] << 8) | p[2];
    if (msglen < clen + 3)
        return 0;
    q = p + 3;
    BIO_indent(bio, indent, 80);
    BIO_printf(bio, "\x41\x53\x4e\x2e\x31\x43\x65\x72\x74\x2c\x20\x6c\x65\x6e\x67\x74\x68\x3d\x25\x64", (int)clen);
    x = d2i_X509(NULL, &q, clen);
    if (!x)
        BIO_puts(bio, "\x3c\x55\x4e\x50\x41\x52\x53\x45\x41\x42\x4c\x45\x20\x43\x45\x52\x54\x49\x46\x49\x43\x41\x54\x45\x3e\xa");
    else {
        BIO_puts(bio, "\xa\x2d\x2d\x2d\x2d\x2d\x2d\x64\x65\x74\x61\x69\x6c\x73\x2d\x2d\x2d\x2d\x2d\xa");
        X509_print_ex(bio, x, XN_FLAG_ONELINE, 0);
        PEM_write_bio_X509(bio, x);
        /* Print certificate stuff */
        BIO_puts(bio, "\x2d\x2d\x2d\x2d\x2d\x2d\x2d\x2d\x2d\x2d\x2d\x2d\x2d\x2d\x2d\x2d\x2d\x2d\xa");
        X509_free(x);
    }
    if (q != p + 3 + clen) {
        BIO_puts(bio, "\x3c\x54\x52\x41\x49\x4c\x49\x4e\x47\x20\x47\x41\x52\x42\x41\x47\x45\x20\x41\x46\x54\x45\x52\x20\x43\x45\x52\x54\x49\x46\x49\x43\x41\x54\x45\x3e\xa");
    }
    *pmsg += clen + 3;
    *pmsglen -= clen + 3;
    return 1;
}

static int ssl_print_certificates(BIO *bio, int indent,
                                  const unsigned char *msg, size_t msglen)
{
    size_t clen;
    if (msglen < 3)
        return 0;
    clen = (msg[0] << 16) | (msg[1] << 8) | msg[2];
    if (msglen != clen + 3)
        return 0;
    msg += 3;
    BIO_indent(bio, indent, 80);
    BIO_printf(bio, "\x63\x65\x72\x74\x69\x66\x69\x63\x61\x74\x65\x5f\x6c\x69\x73\x74\x2c\x20\x6c\x65\x6e\x67\x74\x68\x3d\x25\x64\xa", (int)clen);
    while (clen > 0) {
        if (!ssl_print_certificate(bio, indent + 2, &msg, &clen))
            return 0;
    }
    return 1;
}

static int ssl_print_cert_request(BIO *bio, int indent, SSL *s,
                                  const unsigned char *msg, size_t msglen)
{
    size_t xlen;
    if (msglen < 1)
        return 0;
    xlen = msg[0];
    if (msglen < xlen + 1)
        return 0;
    msg++;
    BIO_indent(bio, indent, 80);
    BIO_printf(bio, "\x63\x65\x72\x74\x69\x66\x69\x63\x61\x74\x65\x5f\x74\x79\x70\x65\x73\x20\x28\x6c\x65\x6e\x3d\x25\x64\x29\xa", (int)xlen);
    if (!ssl_trace_list(bio, indent + 2, msg, xlen, 1, ssl_ctype_tbl))
        return 0;
    msg += xlen;
    msglen -= xlen + 1;
    if (!SSL_USE_SIGALGS(s))
        goto skip_sig;
    if (msglen < 2)
        return 0;
    xlen = (msg[0] << 8) | msg[1];
    if (msglen < xlen + 2 || (xlen & 1))
        return 0;
    msg += 2;
    BIO_indent(bio, indent, 80);
    BIO_printf(bio, "\x73\x69\x67\x6e\x61\x74\x75\x72\x65\x5f\x61\x6c\x67\x6f\x72\x69\x74\x68\x6d\x73\x20\x28\x6c\x65\x6e\x3d\x25\x64\x29\xa", (int)xlen);
    while (xlen > 0) {
        BIO_indent(bio, indent + 2, 80);
        BIO_printf(bio, "\x25\x73\x2b\x25\x73\x20\x28\x25\x64\x2b\x25\x64\x29\xa",
                   ssl_trace_str(msg[0], ssl_md_tbl),
                   ssl_trace_str(msg[1], ssl_sig_tbl), msg[0], msg[1]);
        xlen -= 2;
        msg += 2;
    }
    msg += xlen;
    msglen -= xlen + 2;

 skip_sig:
    xlen = (msg[0] << 8) | msg[1];
    BIO_indent(bio, indent, 80);
    if (msglen < xlen + 2)
        return 0;
    msg += 2;
    msglen -= 2;
    BIO_printf(bio, "\x63\x65\x72\x74\x69\x66\x69\x63\x61\x74\x65\x5f\x61\x75\x74\x68\x6f\x72\x69\x74\x69\x65\x73\x20\x28\x6c\x65\x6e\x3d\x25\x64\x29\xa", (int)xlen);
    while (xlen > 0) {
        size_t dlen;
        X509_NAME *nm;
        const unsigned char *p;
        if (xlen < 2)
            return 0;
        dlen = (msg[0] << 8) | msg[1];
        if (xlen < dlen + 2)
            return 0;
        msg += 2;
        BIO_indent(bio, indent + 2, 80);
        BIO_printf(bio, "\x44\x69\x73\x74\x69\x6e\x67\x75\x69\x73\x68\x65\x64\x4e\x61\x6d\x65\x20\x28\x6c\x65\x6e\x3d\x25\x64\x29\x3a\x20", (int)dlen);
        p = msg;
        nm = d2i_X509_NAME(NULL, &p, dlen);
        if (!nm) {
            BIO_puts(bio, "\x3c\x55\x4e\x50\x41\x52\x53\x45\x41\x42\x4c\x45\x20\x44\x4e\x3e\xa");
        } else {
            X509_NAME_print_ex(bio, nm, 0, XN_FLAG_ONELINE);
            BIO_puts(bio, "\xa");
            X509_NAME_free(nm);
        }
        xlen -= dlen + 2;
        msg += dlen;
    }
    return 1;
}

static int ssl_print_ticket(BIO *bio, int indent,
                            const unsigned char *msg, size_t msglen)
{
    unsigned int tick_life;
    if (msglen == 0) {
        BIO_indent(bio, indent + 2, 80);
        BIO_puts(bio, "\x4e\x6f\x20\x54\x69\x63\x6b\x65\x74\xa");
        return 1;
    }
    if (msglen < 4)
        return 0;
    tick_life = (msg[0] << 24) | (msg[1] << 16) | (msg[2] << 8) | msg[3];
    msglen -= 4;
    msg += 4;
    BIO_indent(bio, indent + 2, 80);
    BIO_printf(bio, "\x74\x69\x63\x6b\x65\x74\x5f\x6c\x69\x66\x65\x74\x69\x6d\x65\x5f\x68\x69\x6e\x74\x3d\x25\x75\xa", tick_life);
    if (!ssl_print_hexbuf(bio, indent + 2, "\x74\x69\x63\x6b\x65\x74", 2, &msg, &msglen))
        return 0;
    if (msglen)
        return 0;
    return 1;
}

static int ssl_print_handshake(BIO *bio, SSL *ssl,
                               const unsigned char *msg, size_t msglen,
                               int indent)
{
    size_t hlen;
    unsigned char htype;
    if (msglen < 4)
        return 0;
    htype = msg[0];
    hlen = (msg[1] << 16) | (msg[2] << 8) | msg[3];
    BIO_indent(bio, indent, 80);
    BIO_printf(bio, "\x25\x73\x2c\x20\x4c\x65\x6e\x67\x74\x68\x3d\x25\x64\xa",
               ssl_trace_str(htype, ssl_handshake_tbl), (int)hlen);
    msg += 4;
    msglen -= 4;
    if (SSL_IS_DTLS(ssl)) {
        if (msglen < 8)
            return 0;
        BIO_indent(bio, indent, 80);
        BIO_printf(bio, "\x6d\x65\x73\x73\x61\x67\x65\x5f\x73\x65\x71\x3d\x25\x64\x2c\x20\x66\x72\x61\x67\x6d\x65\x6e\x74\x5f\x6f\x66\x66\x73\x65\x74\x3d\x25\x64\x2c\x20"
                   "\x66\x72\x61\x67\x6d\x65\x6e\x74\x5f\x6c\x65\x6e\x67\x74\x68\x3d\x25\x64\xa",
                   (msg[0] << 8) | msg[1],
                   (msg[2] << 16) | (msg[3] << 8) | msg[4],
                   (msg[5] << 16) | (msg[6] << 8) | msg[7]);
        msg += 8;
        msglen -= 8;
    }
    if (msglen < hlen)
        return 0;
    switch (htype) {
    case SSL3_MT_CLIENT_HELLO:
        if (!ssl_print_client_hello(bio, ssl, indent + 2, msg, msglen))
            return 0;
        break;

    case DTLS1_MT_HELLO_VERIFY_REQUEST:
        if (!dtls_print_hello_vfyrequest(bio, indent + 2, msg, msglen))
            return 0;
        break;

    case SSL3_MT_SERVER_HELLO:
        if (!ssl_print_server_hello(bio, indent + 2, msg, msglen))
            return 0;
        break;

    case SSL3_MT_SERVER_KEY_EXCHANGE:
        if (!ssl_print_server_keyex(bio, indent + 2, ssl, msg, msglen))
            return 0;
        break;

    case SSL3_MT_CLIENT_KEY_EXCHANGE:
        if (!ssl_print_client_keyex(bio, indent + 2, ssl, msg, msglen))
            return 0;
        break;

    case SSL3_MT_CERTIFICATE:
        if (!ssl_print_certificates(bio, indent + 2, msg, msglen))
            return 0;
        break;

    case SSL3_MT_CERTIFICATE_VERIFY:
        if (!ssl_print_signature(bio, indent + 2, ssl, &msg, &msglen))
            return 0;
        break;

    case SSL3_MT_CERTIFICATE_REQUEST:
        if (!ssl_print_cert_request(bio, indent + 2, ssl, msg, msglen))
            return 0;
        break;

    case SSL3_MT_FINISHED:
        ssl_print_hex(bio, indent + 2, "\x76\x65\x72\x69\x66\x79\x5f\x64\x61\x74\x61", msg, msglen);
        break;

    case SSL3_MT_SERVER_DONE:
        if (msglen != 0)
            ssl_print_hex(bio, indent + 2, "\x75\x6e\x65\x78\x70\x65\x63\x74\x65\x64\x20\x76\x61\x6c\x75\x65", msg, msglen);
        break;

    case SSL3_MT_NEWSESSION_TICKET:
        if (!ssl_print_ticket(bio, indent + 2, msg, msglen))
            return 0;
        break;

    default:
        BIO_indent(bio, indent + 2, 80);
        BIO_puts(bio, "\x55\x6e\x73\x75\x70\x70\x6f\x72\x74\x65\x64\x2c\x20\x68\x65\x78\x20\x64\x75\x6d\x70\x20\x66\x6f\x6c\x6c\x6f\x77\x73\x3a\xa");
        BIO_dump_indent(bio, (char *)msg, msglen, indent + 4);
    }
    return 1;
}

static int ssl_print_heartbeat(BIO *bio, int indent,
                               const unsigned char *msg, size_t msglen)
{
    if (msglen < 3)
        return 0;
    BIO_indent(bio, indent, 80);
    BIO_printf(bio, "\x48\x65\x61\x72\x74\x42\x65\x61\x74\x4d\x65\x73\x73\x61\x67\x65\x54\x79\x70\x65\x3a\x20\x25\x73\xa",
               ssl_trace_str(msg[0], ssl_hb_type_tbl));
    msg++;
    msglen--;
    if (!ssl_print_hexbuf(bio, indent, "\x70\x61\x79\x6c\x6f\x61\x64", 2, &msg, &msglen))
        return 0;
    ssl_print_hex(bio, indent, "\x70\x61\x64\x64\x69\x6e\x67", msg, msglen);
    return 1;
}

const char *SSL_CIPHER_standard_name(const SSL_CIPHER *c)
{
    if (c->algorithm_ssl & SSL_SSLV2)
        return NULL;
    return ssl_trace_str(c->id & 0xFFFF, ssl_ciphers_tbl);
}

void SSL_trace(int write_p, int version, int content_type,
               const void *buf, size_t msglen, SSL *ssl, void *arg)
{
    const unsigned char *msg = buf;
    BIO *bio = arg;

    if (write_p == 2) {
        BIO_puts(bio, "\x53\x65\x73\x73\x69\x6f\x6e\x20");
        ssl_print_hex(bio, 0,
                      ssl_trace_str(content_type, ssl_crypto_tbl),
                      msg, msglen);
        return;
    }
    switch (content_type) {
    case SSL3_RT_HEADER:
        {
            int hvers = msg[1] << 8 | msg[2];
            BIO_puts(bio, write_p ? "\x53\x65\x6e\x74" : "\x52\x65\x63\x65\x69\x76\x65\x64");
            BIO_printf(bio, "\x20\x52\x65\x63\x6f\x72\x64\xa\x48\x65\x61\x64\x65\x72\x3a\xa\x20\x20\x56\x65\x72\x73\x69\x6f\x6e\x20\x3d\x20\x25\x73\x20\x28\x30\x78\x25\x78\x29\xa",
                       ssl_trace_str(hvers, ssl_version_tbl), hvers);
            if (SSL_IS_DTLS(ssl)) {
                BIO_printf(bio,
                           "\x20\x20\x65\x70\x6f\x63\x68\x3d\x25\x64\x2c\x20\x73\x65\x71\x75\x65\x6e\x63\x65\x5f\x6e\x75\x6d\x62\x65\x72\x3d\x25\x30\x34\x78\x25\x30\x34\x78\x25\x30\x34\x78\xa",
                           (msg[3] << 8 | msg[4]),
                           (msg[5] << 8 | msg[6]),
                           (msg[7] << 8 | msg[8]), (msg[9] << 8 | msg[10]));
# if 0
                /*
                 * Just print handshake type so we can see what is going on
                 * during fragmentation.
                 */
                BIO_printf(bio, "\x28\x25\x73\x29\xa",
                           ssl_trace_str(msg[msglen], ssl_handshake_tbl));
# endif
            }

            BIO_printf(bio, "\x20\x20\x43\x6f\x6e\x74\x65\x6e\x74\x20\x54\x79\x70\x65\x20\x3d\x20\x25\x73\x20\x28\x25\x64\x29\xa\x20\x20\x4c\x65\x6e\x67\x74\x68\x20\x3d\x20\x25\x64",
                       ssl_trace_str(msg[0], ssl_content_tbl), msg[0],
                       msg[msglen - 2] << 8 | msg[msglen - 1]);
        }
        break;
    case SSL3_RT_HANDSHAKE:
        if (!ssl_print_handshake(bio, ssl, msg, msglen, 4))
            BIO_printf(bio, "\x4d\x65\x73\x73\x61\x67\x65\x20\x6c\x65\x6e\x67\x74\x68\x20\x70\x61\x72\x73\x65\x20\x65\x72\x72\x6f\x72\x21\xa");
        break;

    case SSL3_RT_CHANGE_CIPHER_SPEC:
        if (msglen == 1 && msg[0] == 1)
            BIO_puts(bio, "\x20\x20\x20\x20\x63\x68\x61\x6e\x67\x65\x5f\x63\x69\x70\x68\x65\x72\x5f\x73\x70\x65\x63\x20\x28\x31\x29\xa");
        else
            ssl_print_hex(bio, 4, "\x75\x6e\x6b\x6e\x6f\x77\x6e\x20\x76\x61\x6c\x75\x65", msg, msglen);
        break;

    case SSL3_RT_ALERT:
        if (msglen != 2) {
            BIO_puts(bio, "\x20\x20\x20\x20\x49\x6c\x6c\x65\x67\x61\x6c\x20\x41\x6c\x65\x72\x74\x20\x4c\x65\x6e\x67\x74\x68\xa");
        } else {
            BIO_printf(bio, "\x20\x20\x20\x20\x4c\x65\x76\x65\x6c\x3d\x25\x73\x28\x25\x64\x29\x2c\x20\x64\x65\x73\x63\x72\x69\x70\x74\x69\x6f\x6e\x3d\x25\x73\x28\x25\x64\x29\xa",
                       SSL_alert_type_string_long(msg[0] << 8),
                       msg[0], SSL_alert_desc_string_long(msg[1]), msg[1]);
        }
        break;

    case TLS1_RT_HEARTBEAT:
        ssl_print_heartbeat(bio, 4, msg, msglen);
        break;

    }

    BIO_puts(bio, "\xa");
}

#endif
